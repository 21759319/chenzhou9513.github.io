<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Chenzhou" />










<meta name="description" content="Mobile NetÁÆÄ‰ªãüö¥ÊñáÁ´†Ôºö Mobbile Net  https://arxiv.org/abs/1704.04861 Mobbile Net V2  https://arxiv.org/pdf/1801.04381.pdf">
<meta property="og:type" content="article">
<meta property="og:title" content="Mobile Net">
<meta property="og:url" content="http://yoursite.com/2018/11/02/mobilenet/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Mobile NetÁÆÄ‰ªãüö¥ÊñáÁ´†Ôºö Mobbile Net  https://arxiv.org/abs/1704.04861 Mobbile Net V2  https://arxiv.org/pdf/1801.04381.pdf">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2018/11/02/mobilenet/conv.png">
<meta property="og:image" content="http://yoursite.com/2018/11/02/mobilenet/newconv.jpg">
<meta property="og:image" content="http://yoursite.com/2018/11/02/mobilenet/compare.png">
<meta property="og:image" content="http://yoursite.com/2018/11/02/mobilenet/compare2.png">
<meta property="og:updated_time" content="2018-11-03T07:35:45.606Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mobile Net">
<meta name="twitter:description" content="Mobile NetÁÆÄ‰ªãüö¥ÊñáÁ´†Ôºö Mobbile Net  https://arxiv.org/abs/1704.04861 Mobbile Net V2  https://arxiv.org/pdf/1801.04381.pdf">
<meta name="twitter:image" content="http://yoursite.com/2018/11/02/mobilenet/conv.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","sidebar":false}},
    duoshuo: {
      userId: '0',
      author: 'Âçö‰∏ª'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/11/02/mobilenet/"/>





  <title>Mobile Net | Blog</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            È¶ñÈ°µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            ÂÖ≥‰∫é
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            ÂàÜÁ±ª
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            ÂΩíÊ°£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/02/mobilenet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Zhou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Mobile Net</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">ÂèëË°®‰∫é</span>
              
              <time title="ÂàõÂª∫‰∫é" itemprop="dateCreated datePublished" datetime="2018-11-02T17:58:32+08:00">
                2018-11-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>Ê¨°
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Mobile-Net"><a href="#Mobile-Net" class="headerlink" title="Mobile Net"></a>Mobile Net</h1><h2 id="&#x7B80;&#x4ECB;"><a href="#&#x7B80;&#x4ECB;" class="headerlink" title="&#x7B80;&#x4ECB;"></a>&#x7B80;&#x4ECB;</h2><p>&#x1F6B4;&#x6587;&#x7AE0;&#xFF1A;</p>
<p>Mobbile Net  <a href="https://arxiv.org/abs/1704.04861" target="_blank" rel="noopener">https://arxiv.org/abs/1704.04861</a></p>
<p>Mobbile Net V2  <a href="https://arxiv.org/pdf/1801.04381.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/1801.04381.pdf</a></p>
<a id="more"></a>
<h2 id="Depthwise-Convolution-&#x548C;-Pointwise-Convolution"><a href="#Depthwise-Convolution-&#x548C;-Pointwise-Convolution" class="headerlink" title="Depthwise Convolution &#x548C; Pointwise Convolution"></a>Depthwise Convolution &#x548C; Pointwise Convolution</h2><h3 id="Convolution"><a href="#Convolution" class="headerlink" title="Convolution"></a>Convolution</h3><p>&#x666E;&#x901A;&#x5377;&#x79EF;&#x662F;  &#x5377;&#x79EF;&#x6838;&#x7684;&#x901A;&#x9053;&#x6570;&#x548C;&#x88AB;&#x5377;&#x79EF;&#x5BF9;&#x8C61;&#x7684;&#x901A;&#x9053;&#x6570;&#x4E00;&#x81F4;&#xFF0C;&#x5E76;&#x4E14;&#x8FDB;&#x884C;&#x5BF9;&#x5E94;&#x4F4D;&#x7F6E;&#x76F8;&#x4E58;&#x5F97;&#x6765;</p>
<p><img src="/2018/11/02/mobilenet/conv.png"></p>
<p>&#x6BD4;&#x5982;&#x8F93;&#x5165;&#x56FE;&#x7247;(128,128,3) , &#x5377;&#x79EF;&#x6838;&#x7528;16&#x4E2A;(2,2)&#x7684;&#x5377;&#x79EF;&#x6838;&#xFF0C;&#x8F93;&#x51FA;(128,128,16)</p>
<h2 id="Depthwise-Convolution"><a href="#Depthwise-Convolution" class="headerlink" title="Depthwise Convolution"></a>Depthwise Convolution</h2><p>&#x4E0E;&#x666E;&#x901A;&#x5377;&#x79EF;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x6838;&#x4E0D;&#x518D;&#x8D1F;&#x8D23;&#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x5168;&#x90E8;&#x901A;&#x9053;&#x4E86;&#xFF0C;&#x53EA;&#x8D1F;&#x8D23;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x901A;&#x9053;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF1A; &#x8F93;&#x5165;(128,128,3) &#xFF0C; &#x7528;3&#x4E2A;(2,2)&#x7684;&#x5377;&#x79EF;&#x6838;&#x505A;depthwise&#xFF0C;&#x5F97;&#x5230;&#x7684;&#x662F;(128,128,3)</p>
<h2 id="Pointwise-Convolution"><a href="#Pointwise-Convolution" class="headerlink" title="Pointwise Convolution"></a>Pointwise Convolution</h2><p>&#x4E0E;&#x666E;&#x901A;&#x5377;&#x79EF;&#x5F88;&#x50CF;&#xFF0C;&#x5C31;&#x662F;&#x628A;&#x5377;&#x79EF;&#x5927;&#x5C0F;&#x5B9A;&#x4E49;&#x4E3A;(1,1)</p>
<p><img src="/2018/11/02/mobilenet/newconv.jpg"></p>
<h2 id="MobileNet&#x6A21;&#x578B;"><a href="#MobileNet&#x6A21;&#x578B;" class="headerlink" title="MobileNet&#x6A21;&#x578B;"></a>MobileNet&#x6A21;&#x578B;</h2><p>keras &#x5B9E;&#x73B0;&#x7684;&#x6A21;&#x578B;&#x7ED3;&#x6784;</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.applications <span class="keyword">import</span> MobileNet</span><br><span class="line">model = MobileNet(input_shape=(<span class="number">128</span>,<span class="number">128</span>,<span class="number">3</span>),weights=<span class="keyword">None</span>,alpha=<span class="number">1</span>,classes=<span class="number">16</span>)</span><br><span class="line">model.summary()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">_________________________________________________________________</span><br><span class="line">Layer (type)                 Output Shape              Param <span class="comment">#   </span></span><br><span class="line">=================================================================</span><br><span class="line">input_4 (InputLayer)         (<span class="keyword">None</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">3</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv1_pad (ZeroPadding2D)    (<span class="keyword">None</span>, <span class="number">129</span>, <span class="number">129</span>, <span class="number">3</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv1 (Conv2D)               (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">864</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv1_bn (BatchNormalization (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">128</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv1_relu (ReLU)            (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_1 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">288</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_1_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">128</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_1_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_1 (Conv2D)           (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>)        <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_1_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>)        <span class="number">256</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_1_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pad_2 (ZeroPadding2D)   (<span class="keyword">None</span>, <span class="number">65</span>, <span class="number">65</span>, <span class="number">64</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_2 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">64</span>)        <span class="number">576</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_2_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">64</span>)        <span class="number">256</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_2_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">64</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_2 (Conv2D)           (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">8192</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_2_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">512</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_2_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_3 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">1152</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_3_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">512</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_3_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_3 (Conv2D)           (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">16384</span>     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_3_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">512</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_3_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">128</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pad_4 (ZeroPadding2D)   (<span class="keyword">None</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">128</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_4 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">128</span>)       <span class="number">1152</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_4_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">128</span>)       <span class="number">512</span>       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_4_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">128</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_4 (Conv2D)           (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">32768</span>     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_4_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">1024</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_4_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_5 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">2304</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_5_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">1024</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_5_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_5 (Conv2D)           (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">65536</span>     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_5_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">1024</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_5_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">256</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pad_6 (ZeroPadding2D)   (<span class="keyword">None</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">256</span>)       <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_6 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">256</span>)         <span class="number">2304</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_6_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">256</span>)         <span class="number">1024</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_6_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">256</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_6 (Conv2D)           (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">131072</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_6_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_6_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_7 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_7_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_7_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_7 (Conv2D)           (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">262144</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_7_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_7_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_8 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_8_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_8_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_8 (Conv2D)           (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">262144</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_8_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_8_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_9 (DepthwiseConv2D)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_9_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_9_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_9 (Conv2D)           (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">262144</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_9_bn (BatchNormaliza (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_9_relu (ReLU)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_10 (DepthwiseConv2D) (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_10_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_10_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_10 (Conv2D)          (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">262144</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_10_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_10_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_11 (DepthwiseConv2D) (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_11_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_11_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_11 (Conv2D)          (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">262144</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_11_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_11_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pad_12 (ZeroPadding2D)  (<span class="keyword">None</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_12 (DepthwiseConv2D) (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">512</span>)         <span class="number">4608</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_12_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">512</span>)         <span class="number">2048</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_12_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">512</span>)         <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_12 (Conv2D)          (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">524288</span>    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_12_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">4096</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_12_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_13 (DepthwiseConv2D) (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">9216</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_13_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">4096</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_dw_13_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_13 (Conv2D)          (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">1048576</span>   </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_13_bn (BatchNormaliz (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">4096</span>      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_pw_13_relu (ReLU)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1024</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">global_average_pooling2d_3 ( (<span class="keyword">None</span>, <span class="number">1024</span>)              <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">reshape_1 (Reshape)          (<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1024</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dropout (Dropout)            (<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1024</span>)        <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv_preds (Conv2D)          (<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">16</span>)          <span class="number">16400</span>     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">act_softmax (Activation)     (<span class="keyword">None</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">16</span>)          <span class="number">0</span>         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">reshape_2 (Reshape)          (<span class="keyword">None</span>, <span class="number">16</span>)                <span class="number">0</span>         </span><br><span class="line">=================================================================</span><br><span class="line">Total params: <span class="number">3</span>,<span class="number">245</span>,<span class="number">264</span></span><br><span class="line">Trainable params: <span class="number">3</span>,<span class="number">223</span>,<span class="number">376</span></span><br><span class="line">Non-trainable params: <span class="number">21</span>,<span class="number">888</span></span><br><span class="line">_________________________________________________________________</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6E90;&#x7801;&#x6807;&#x6CE8;</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MobileNet</span><span class="params">(input_shape=None,</span></span></span><br><span class="line"><span class="function"><span class="params">              alpha=<span class="number">1.0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              depth_multiplier=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              dropout=<span class="number">1e-3</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              include_top=True,</span></span></span><br><span class="line"><span class="function"><span class="params">              weights=<span class="string">&apos;imagenet&apos;</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              input_tensor=None,</span></span></span><br><span class="line"><span class="function"><span class="params">              pooling=None,</span></span></span><br><span class="line"><span class="function"><span class="params">              classes=<span class="number">1000</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              **kwargs)</span>:</span></span><br><span class="line">    </span><br><span class="line">   <span class="comment">#padding -&gt; conv2d(32,(3,3)) s=2 -&gt; bn -&gt; relu6 </span></span><br><span class="line">    x = _conv_block(img_input, <span class="number">32</span>, alpha, strides=(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(64*alpha,(1,1)) s=1 -&gt; bn -&gt; relu6</span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">64</span>, alpha, depth_multiplier, block_id=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(128*alpha,(1,1)) s=2 -&gt; bn -&gt; relu6</span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">128</span>, alpha, depth_multiplier,</span><br><span class="line">                              strides=(<span class="number">2</span>, <span class="number">2</span>), block_id=<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(128*alpha,(1,1)) s=1 -&gt; bn -&gt; relu6</span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">128</span>, alpha, depth_multiplier, block_id=<span class="number">3</span>)</span><br><span class="line">   </span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(256*alpha,(1,1)) s=2 -&gt; bn -&gt; relu6</span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">256</span>, alpha, depth_multiplier,</span><br><span class="line">                              strides=(<span class="number">2</span>, <span class="number">2</span>), block_id=<span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(256*alpha,(1,1)) s=1 -&gt; bn -&gt; relu6</span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">256</span>, alpha, depth_multiplier, block_id=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(512*alpha,(1,1)) s=2 -&gt; bn -&gt; relu6    </span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier,</span><br><span class="line">                              strides=(<span class="number">2</span>, <span class="number">2</span>), block_id=<span class="number">6</span>)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(512*alpha,(1,1)) s=1 -&gt; bn -&gt; relu6</span></span><br><span class="line">   <span class="comment">#&#x91CD;&#x590D;&#x4E94;&#x6B21; </span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier, block_id=<span class="number">7</span>)</span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier, block_id=<span class="number">8</span>)</span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier, block_id=<span class="number">9</span>)</span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier, block_id=<span class="number">10</span>)</span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">512</span>, alpha, depth_multiplier, block_id=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(1024*alpha,(1,1)) s=2 -&gt; bn -&gt; relu6    </span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">1024</span>, alpha, depth_multiplier,</span><br><span class="line">                              strides=(<span class="number">2</span>, <span class="number">2</span>), block_id=<span class="number">12</span>)</span><br><span class="line">  <span class="comment">#DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(1024*alpha,(1,1)) s=1 -&gt; bn -&gt; relu6   </span></span><br><span class="line">    x = _depthwise_conv_block(x, <span class="number">1024</span>, alpha, depth_multiplier, block_id=<span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> include_top:</span><br><span class="line">        <span class="keyword">if</span> backend.image_data_format() == <span class="string">&apos;channels_first&apos;</span>:</span><br><span class="line">            shape = (int(<span class="number">1024</span> * alpha), <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            shape = (<span class="number">1</span>, <span class="number">1</span>, int(<span class="number">1024</span> * alpha))</span><br><span class="line"></span><br><span class="line">        x = layers.GlobalAveragePooling2D()(x)</span><br><span class="line">        x = layers.Reshape(shape, name=<span class="string">&apos;reshape_1&apos;</span>)(x)</span><br><span class="line">        x = layers.Dropout(dropout, name=<span class="string">&apos;dropout&apos;</span>)(x)</span><br><span class="line">        x = layers.Conv2D(classes, (<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">                          padding=<span class="string">&apos;same&apos;</span>,</span><br><span class="line">                          name=<span class="string">&apos;conv_preds&apos;</span>)(x)</span><br><span class="line">        x = layers.Activation(<span class="string">&apos;softmax&apos;</span>, name=<span class="string">&apos;act_softmax&apos;</span>)(x)</span><br><span class="line">        x = layers.Reshape((classes,), name=<span class="string">&apos;reshape_2&apos;</span>)(x)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_depthwise_conv_block</span><span class="params">(inputs, pointwise_conv_filters, alpha,</span></span></span><br><span class="line"><span class="function"><span class="params">                          depth_multiplier=<span class="number">1</span>, strides=<span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span>, block_id=<span class="number">1</span>)</span>:</span></span><br><span class="line"></span><br><span class="line">    channel_axis = <span class="number">1</span> <span class="keyword">if</span> backend.image_data_format() == <span class="string">&apos;channels_first&apos;</span> <span class="keyword">else</span> <span class="number">-1</span></span><br><span class="line">    pointwise_conv_filters = int(pointwise_conv_filters * alpha)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> strides == (<span class="number">1</span>, <span class="number">1</span>):</span><br><span class="line">        x = inputs</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x = layers.ZeroPadding2D(((<span class="number">0</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">1</span>)),</span><br><span class="line">                                 name=<span class="string">&apos;conv_pad_%d&apos;</span> % block_id)(inputs)</span><br><span class="line">    x = layers.DepthwiseConv2D((<span class="number">3</span>, <span class="number">3</span>),</span><br><span class="line">                               padding=<span class="string">&apos;same&apos;</span> <span class="keyword">if</span> strides == (<span class="number">1</span>, <span class="number">1</span>) <span class="keyword">else</span> <span class="string">&apos;valid&apos;</span>,</span><br><span class="line">                               depth_multiplier=depth_multiplier,</span><br><span class="line">                               strides=strides,</span><br><span class="line">                               use_bias=<span class="keyword">False</span>,</span><br><span class="line">                               name=<span class="string">&apos;conv_dw_%d&apos;</span> % block_id)(x)</span><br><span class="line">    x = layers.BatchNormalization(</span><br><span class="line">        axis=channel_axis, name=<span class="string">&apos;conv_dw_%d_bn&apos;</span> % block_id)(x)</span><br><span class="line">    x = layers.ReLU(<span class="number">6.</span>, name=<span class="string">&apos;conv_dw_%d_relu&apos;</span> % block_id)(x)</span><br><span class="line"></span><br><span class="line">    x = layers.Conv2D(pointwise_conv_filters, (<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">                      padding=<span class="string">&apos;same&apos;</span>,</span><br><span class="line">                      use_bias=<span class="keyword">False</span>,</span><br><span class="line">                      strides=(<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">                      name=<span class="string">&apos;conv_pw_%d&apos;</span> % block_id)(x)</span><br><span class="line">    x = layers.BatchNormalization(axis=channel_axis,</span><br><span class="line">                                  name=<span class="string">&apos;conv_pw_%d_bn&apos;</span> % block_id)(x)</span><br><span class="line">    <span class="keyword">return</span> layers.ReLU(<span class="number">6.</span>, name=<span class="string">&apos;conv_pw_%d_relu&apos;</span> % block_id)(x)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x603B;&#x7ED3;&#xFF1A;</p>
<ol>
<li><p>&#x5148;&#x5377;&#x79EF;&#x5C06;size&#x7F29;&#x5C0F;&#xFF0C;&#x56FA;&#x5B9A;channel&#x5230;32</p>
</li>
<li><p>&#x591A;&#x6B21;&#x8FDB;&#x884C;DepthwiseConvolution(3,3) -&gt; bn -&gt; relu6 -&gt; conv2d(filter*alpha,(1,1))  s=? -&gt; bn -&gt; relu6</p>
<p>&#x5373;&#x5148;Depthwise Convolution &#x518D;Pointwise Convolution</p>
<p>s=1&#x548C;s=2&#x4EA4;&#x66FF;&#x8FDB;&#x884C;&#xFF0C;&#x9010;&#x6E10;&#x7F29;&#x5C0F;size</p>
</li>
<li><p>&#x8FDE;&#x63A5;top&#xFF0C;&#x8FDB;&#x884C;&#x5206;&#x7C7B;</p>
</li>
</ol>
<h2 id="MobileNetV2&#x6A21;&#x578B;"><a href="#MobileNetV2&#x6A21;&#x578B;" class="headerlink" title="MobileNetV2&#x6A21;&#x578B;"></a>MobileNetV2&#x6A21;&#x578B;</h2><p><img src="/2018/11/02/mobilenet/compare.png"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.applications <span class="keyword">import</span> MobileNetV2</span><br><span class="line">model = MobileNetV2(input_shape=(<span class="number">128</span>,<span class="number">128</span>,<span class="number">3</span>),weights=<span class="keyword">None</span>,alpha=<span class="number">1.0</span>,classes=<span class="number">16</span>)</span><br><span class="line">model.summary()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Layer (type)                    Output Shape         Param <span class="comment">#     Connected to                     </span></span><br><span class="line">==================================================================================================</span><br><span class="line">input_5 (InputLayer)            (<span class="keyword">None</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">3</span>)  <span class="number">0</span>                                            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Conv1_pad (ZeroPadding2D)       (<span class="keyword">None</span>, <span class="number">129</span>, <span class="number">129</span>, <span class="number">3</span>)  <span class="number">0</span>           input_5[<span class="number">0</span>][<span class="number">0</span>]                    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Conv1 (Conv2D)                  (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">864</span>         Conv1_pad[<span class="number">0</span>][<span class="number">0</span>]                  </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">bn_Conv1 (BatchNormalization)   (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">128</span>         Conv1[<span class="number">0</span>][<span class="number">0</span>]                      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Conv1_relu (ReLU)               (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">0</span>           bn_Conv1[<span class="number">0</span>][<span class="number">0</span>]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">expanded_conv_depthwise (Depthw (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">288</span>         Conv1_relu[<span class="number">0</span>][<span class="number">0</span>]                 </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">expanded_conv_depthwise_BN (Bat (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">128</span>         expanded_conv_depthwise[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">expanded_conv_depthwise_relu (R (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">32</span>)   <span class="number">0</span>           expanded_conv_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>] </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">expanded_conv_project (Conv2D)  (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">16</span>)   <span class="number">512</span>         expanded_conv_depthwise_relu[<span class="number">0</span>][<span class="number">0</span></span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">expanded_conv_project_BN (Batch (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">16</span>)   <span class="number">64</span>          expanded_conv_project[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">96</span>)   <span class="number">1536</span>        expanded_conv_project_BN[<span class="number">0</span>][<span class="number">0</span>]   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">96</span>)   <span class="number">384</span>         block_1_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">96</span>)   <span class="number">0</span>           block_1_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_pad (ZeroPadding2D)     (<span class="keyword">None</span>, <span class="number">65</span>, <span class="number">65</span>, <span class="number">96</span>)   <span class="number">0</span>           block_1_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">96</span>)   <span class="number">864</span>         block_1_pad[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">96</span>)   <span class="number">384</span>         block_1_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">96</span>)   <span class="number">0</span>           block_1_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">24</span>)   <span class="number">2304</span>        block_1_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_1_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">24</span>)   <span class="number">96</span>          block_1_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">3456</span>        block_1_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">576</span>         block_2_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">0</span>           block_2_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">1296</span>        block_2_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">576</span>         block_2_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">0</span>           block_2_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">24</span>)   <span class="number">3456</span>        block_2_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">24</span>)   <span class="number">96</span>          block_2_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_2_add (Add)               (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">24</span>)   <span class="number">0</span>           block_1_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">                                                                 block_2_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">3456</span>        block_2_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">576</span>         block_3_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">144</span>)  <span class="number">0</span>           block_3_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_pad (ZeroPadding2D)     (<span class="keyword">None</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">144</span>)  <span class="number">0</span>           block_3_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">144</span>)  <span class="number">1296</span>        block_3_pad[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">144</span>)  <span class="number">576</span>         block_3_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">144</span>)  <span class="number">0</span>           block_3_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">4608</span>        block_3_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_3_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">128</span>         block_3_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">6144</span>        block_3_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">768</span>         block_4_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">0</span>           block_4_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">1728</span>        block_4_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">768</span>         block_4_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">0</span>           block_4_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">6144</span>        block_4_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">128</span>         block_4_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_4_add (Add)               (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">0</span>           block_3_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">                                                                 block_4_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">6144</span>        block_4_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">768</span>         block_5_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">0</span>           block_5_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">1728</span>        block_5_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">768</span>         block_5_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">0</span>           block_5_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">6144</span>        block_5_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">128</span>         block_5_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_5_add (Add)               (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">32</span>)   <span class="number">0</span>           block_4_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">                                                                 block_5_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">6144</span>        block_5_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">768</span>         block_6_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">192</span>)  <span class="number">0</span>           block_6_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_pad (ZeroPadding2D)     (<span class="keyword">None</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">192</span>)  <span class="number">0</span>           block_6_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">192</span>)    <span class="number">1728</span>        block_6_pad[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">192</span>)    <span class="number">768</span>         block_6_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">192</span>)    <span class="number">0</span>           block_6_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">12288</span>       block_6_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_6_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">256</span>         block_6_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">24576</span>       block_6_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_7_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_7_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">3456</span>        block_7_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_7_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_7_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">24576</span>       block_7_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">256</span>         block_7_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_7_add (Add)               (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">0</span>           block_6_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">                                                                 block_7_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">24576</span>       block_7_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_8_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_8_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">3456</span>        block_8_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_8_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_8_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">24576</span>       block_8_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">256</span>         block_8_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_8_add (Add)               (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">0</span>           block_7_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">                                                                 block_8_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_expand (Conv2D)         (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">24576</span>       block_8_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_expand_BN (BatchNormali (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_9_expand[<span class="number">0</span>][<span class="number">0</span>]             </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_expand_relu (ReLU)      (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_9_expand_BN[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_depthwise (DepthwiseCon (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">3456</span>        block_9_expand_relu[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_depthwise_BN (BatchNorm (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_9_depthwise[<span class="number">0</span>][<span class="number">0</span>]          </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_depthwise_relu (ReLU)   (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_9_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_project (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">24576</span>       block_9_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_project_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">256</span>         block_9_project[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_9_add (Add)               (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">64</span>)     <span class="number">0</span>           block_8_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">                                                                 block_9_project_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">24576</span>       block_9_add[<span class="number">0</span>][<span class="number">0</span>]                </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_10_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_10_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">3456</span>        block_10_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">1536</span>        block_10_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">384</span>)    <span class="number">0</span>           block_10_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">36864</span>       block_10_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_10_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">384</span>         block_10_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">55296</span>       block_10_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_11_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">0</span>           block_11_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">5184</span>        block_11_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_11_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">0</span>           block_11_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">55296</span>       block_11_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">384</span>         block_11_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_11_add (Add)              (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">0</span>           block_10_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">                                                                 block_11_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">55296</span>       block_11_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_12_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">0</span>           block_12_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">5184</span>        block_12_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_12_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">0</span>           block_12_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">55296</span>       block_12_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">384</span>         block_12_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_12_add (Add)              (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">96</span>)     <span class="number">0</span>           block_11_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">                                                                 block_12_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">55296</span>       block_12_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_13_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">576</span>)    <span class="number">0</span>           block_13_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_pad (ZeroPadding2D)    (<span class="keyword">None</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">576</span>)    <span class="number">0</span>           block_13_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">576</span>)    <span class="number">5184</span>        block_13_pad[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">576</span>)    <span class="number">2304</span>        block_13_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">576</span>)    <span class="number">0</span>           block_13_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">92160</span>       block_13_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_13_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">640</span>         block_13_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">153600</span>      block_13_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_14_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_14_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">8640</span>        block_14_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_14_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_14_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">153600</span>      block_14_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">640</span>         block_14_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_14_add (Add)              (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">0</span>           block_13_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">                                                                 block_14_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">153600</span>      block_14_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_15_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_15_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">8640</span>        block_15_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_15_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_15_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">153600</span>      block_15_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">640</span>         block_15_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_15_add (Add)              (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">160</span>)    <span class="number">0</span>           block_14_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">                                                                 block_15_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_expand (Conv2D)        (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">153600</span>      block_15_add[<span class="number">0</span>][<span class="number">0</span>]               </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_expand_BN (BatchNormal (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_16_expand[<span class="number">0</span>][<span class="number">0</span>]            </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_expand_relu (ReLU)     (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_16_expand_BN[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_depthwise (DepthwiseCo (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">8640</span>        block_16_expand_relu[<span class="number">0</span>][<span class="number">0</span>]       </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_depthwise_BN (BatchNor (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">3840</span>        block_16_depthwise[<span class="number">0</span>][<span class="number">0</span>]         </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_depthwise_relu (ReLU)  (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">960</span>)    <span class="number">0</span>           block_16_depthwise_BN[<span class="number">0</span>][<span class="number">0</span>]      </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_project (Conv2D)       (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">320</span>)    <span class="number">307200</span>      block_16_depthwise_relu[<span class="number">0</span>][<span class="number">0</span>]    </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">block_16_project_BN (BatchNorma (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">320</span>)    <span class="number">1280</span>        block_16_project[<span class="number">0</span>][<span class="number">0</span>]           </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Conv_1 (Conv2D)                 (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1280</span>)   <span class="number">409600</span>      block_16_project_BN[<span class="number">0</span>][<span class="number">0</span>]        </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Conv_1_bn (BatchNormalization)  (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1280</span>)   <span class="number">5120</span>        Conv_1[<span class="number">0</span>][<span class="number">0</span>]                     </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">out_relu (ReLU)                 (<span class="keyword">None</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1280</span>)   <span class="number">0</span>           Conv_1_bn[<span class="number">0</span>][<span class="number">0</span>]                  </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">global_average_pooling2d_4 (Glo (<span class="keyword">None</span>, <span class="number">1280</span>)         <span class="number">0</span>           out_relu[<span class="number">0</span>][<span class="number">0</span>]                   </span><br><span class="line">__________________________________________________________________________________________________</span><br><span class="line">Logits (Dense)                  (<span class="keyword">None</span>, <span class="number">16</span>)           <span class="number">20496</span>       global_average_pooling2d_4[<span class="number">0</span>][<span class="number">0</span>] </span><br><span class="line">==================================================================================================</span><br><span class="line">Total params: <span class="number">2</span>,<span class="number">278</span>,<span class="number">480</span></span><br><span class="line">Trainable params: <span class="number">2</span>,<span class="number">244</span>,<span class="number">368</span></span><br><span class="line">Non-trainable params: <span class="number">34</span>,<span class="number">112</span></span><br><span class="line">__________________________________________________________________________________________</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MobileNetV2</span><span class="params">(input_shape=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                alpha=<span class="number">1.0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                depth_multiplier=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                include_top=True,</span></span></span><br><span class="line"><span class="function"><span class="params">                weights=<span class="string">&apos;imagenet&apos;</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                input_tensor=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                pooling=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                classes=<span class="number">1000</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                **kwargs)</span>:</span></span><br><span class="line">                </span><br><span class="line">    <span class="keyword">if</span> input_tensor <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        img_input = layers.Input(shape=input_shape)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> backend.is_keras_tensor(input_tensor):</span><br><span class="line">            img_input = layers.Input(tensor=input_tensor, shape=input_shape)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img_input = input_tensor</span><br><span class="line"></span><br><span class="line">    first_block_filters = _make_divisible(<span class="number">32</span> * alpha, <span class="number">8</span>)</span><br><span class="line">   </span><br><span class="line">    x = layers.ZeroPadding2D(padding=correct_pad(backend, img_input, <span class="number">3</span>),</span><br><span class="line">                             name=<span class="string">&apos;Conv1_pad&apos;</span>)(img_input)</span><br><span class="line">    x = layers.Conv2D(first_block_filters,</span><br><span class="line">                      kernel_size=<span class="number">3</span>,</span><br><span class="line">                      strides=(<span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">                      padding=<span class="string">&apos;valid&apos;</span>,</span><br><span class="line">                      use_bias=<span class="keyword">False</span>,</span><br><span class="line">                      name=<span class="string">&apos;Conv1&apos;</span>)(x)</span><br><span class="line">    x = layers.BatchNormalization(</span><br><span class="line">        epsilon=<span class="number">1e-3</span>, momentum=<span class="number">0.999</span>, name=<span class="string">&apos;bn_Conv1&apos;</span>)(x)</span><br><span class="line">    x = layers.ReLU(<span class="number">6.</span>, name=<span class="string">&apos;Conv1_relu&apos;</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">16</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">1</span>, block_id=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">24</span>, alpha=alpha, stride=<span class="number">2</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">1</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">24</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">32</span>, alpha=alpha, stride=<span class="number">2</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">3</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">32</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">4</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">32</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">64</span>, alpha=alpha, stride=<span class="number">2</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">6</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">64</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">7</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">64</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">8</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">64</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">96</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">10</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">96</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">11</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">96</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">160</span>, alpha=alpha, stride=<span class="number">2</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">13</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">160</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">14</span>)</span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">160</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">    x = _inverted_res_block(x, filters=<span class="number">320</span>, alpha=alpha, stride=<span class="number">1</span>,</span><br><span class="line">                            expansion=<span class="number">6</span>, block_id=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># no alpha applied to last conv as stated in the paper:</span></span><br><span class="line">    <span class="comment"># if the width multiplier is greater than 1 we</span></span><br><span class="line">    <span class="comment"># increase the number of output channels</span></span><br><span class="line">    <span class="keyword">if</span> alpha &gt; <span class="number">1.0</span>:</span><br><span class="line">        last_block_filters = _make_divisible(<span class="number">1280</span> * alpha, <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        last_block_filters = <span class="number">1280</span></span><br><span class="line"></span><br><span class="line">    x = layers.Conv2D(last_block_filters,</span><br><span class="line">                      kernel_size=<span class="number">1</span>,</span><br><span class="line">                      use_bias=<span class="keyword">False</span>,</span><br><span class="line">                      name=<span class="string">&apos;Conv_1&apos;</span>)(x)</span><br><span class="line">    x = layers.BatchNormalization(epsilon=<span class="number">1e-3</span>,</span><br><span class="line">                                  momentum=<span class="number">0.999</span>,</span><br><span class="line">                                  name=<span class="string">&apos;Conv_1_bn&apos;</span>)(x)</span><br><span class="line">    x = layers.ReLU(<span class="number">6.</span>, name=<span class="string">&apos;out_relu&apos;</span>)(x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> include_top:</span><br><span class="line">        x = layers.GlobalAveragePooling2D()(x)</span><br><span class="line">        x = layers.Dense(classes, activation=<span class="string">&apos;softmax&apos;</span>,</span><br><span class="line">                         use_bias=<span class="keyword">True</span>, name=<span class="string">&apos;Logits&apos;</span>)(x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> pooling == <span class="string">&apos;avg&apos;</span>:</span><br><span class="line">            x = layers.GlobalAveragePooling2D()(x)</span><br><span class="line">        <span class="keyword">elif</span> pooling == <span class="string">&apos;max&apos;</span>:</span><br><span class="line">            x = layers.GlobalMaxPooling2D()(x)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_inverted_res_block</span><span class="params">(inputs, expansion, stride, alpha, filters, block_id)</span>:</span></span><br><span class="line">    in_channels = backend.int_shape(inputs)[<span class="number">-1</span>]</span><br><span class="line">    pointwise_conv_filters = int(filters * alpha)</span><br><span class="line">    pointwise_filters = _make_divisible(pointwise_conv_filters, <span class="number">8</span>)</span><br><span class="line">    x = inputs</span><br><span class="line">    prefix = <span class="string">&apos;block_{}_&apos;</span>.format(block_id)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> block_id:</span><br><span class="line">        <span class="comment"># Expand</span></span><br><span class="line">        <span class="comment"># pw &#x8FDB;&#x884C;&#x518D;channels&#x4E0A;&#x7684;&#x653E;&#x5927;&#xFF0C; &#x653E;&#x5927;&#x4E3A; expansion * in_channels</span></span><br><span class="line">        x = layers.Conv2D(expansion * in_channels,</span><br><span class="line">                          kernel_size=<span class="number">1</span>,</span><br><span class="line">                          padding=<span class="string">&apos;same&apos;</span>,</span><br><span class="line">                          use_bias=<span class="keyword">False</span>,</span><br><span class="line">                          activation=<span class="keyword">None</span>,</span><br><span class="line">                          name=prefix + <span class="string">&apos;expand&apos;</span>)(x)</span><br><span class="line">        x = layers.BatchNormalization(epsilon=<span class="number">1e-3</span>,</span><br><span class="line">                                      momentum=<span class="number">0.999</span>,</span><br><span class="line">                                      name=prefix + <span class="string">&apos;expand_BN&apos;</span>)(x)</span><br><span class="line">        x = layers.ReLU(<span class="number">6.</span>, name=prefix + <span class="string">&apos;expand_relu&apos;</span>)(x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        prefix = <span class="string">&apos;expanded_conv_&apos;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Depthwise</span></span><br><span class="line">    <span class="keyword">if</span> stride == <span class="number">2</span>:</span><br><span class="line">        x = layers.ZeroPadding2D(padding=correct_pad(backend, x, <span class="number">3</span>),</span><br><span class="line">                                 name=prefix + <span class="string">&apos;pad&apos;</span>)(x)</span><br><span class="line">    x = layers.DepthwiseConv2D(kernel_size=<span class="number">3</span>,</span><br><span class="line">                               strides=stride,</span><br><span class="line">                               activation=<span class="keyword">None</span>,</span><br><span class="line">                               use_bias=<span class="keyword">False</span>,</span><br><span class="line">                               padding=<span class="string">&apos;same&apos;</span> <span class="keyword">if</span> stride == <span class="number">1</span> <span class="keyword">else</span> <span class="string">&apos;valid&apos;</span>,</span><br><span class="line">                               name=prefix + <span class="string">&apos;depthwise&apos;</span>)(x)</span><br><span class="line">    x = layers.BatchNormalization(epsilon=<span class="number">1e-3</span>,</span><br><span class="line">                                  momentum=<span class="number">0.999</span>,</span><br><span class="line">                                  name=prefix + <span class="string">&apos;depthwise_BN&apos;</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = layers.ReLU(<span class="number">6.</span>, name=prefix + <span class="string">&apos;depthwise_relu&apos;</span>)(x)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Project   pw </span></span><br><span class="line">    x = layers.Conv2D(pointwise_filters,</span><br><span class="line">                      kernel_size=<span class="number">1</span>,</span><br><span class="line">                      padding=<span class="string">&apos;same&apos;</span>,</span><br><span class="line">                      use_bias=<span class="keyword">False</span>,</span><br><span class="line">                      activation=<span class="keyword">None</span>,</span><br><span class="line">                      name=prefix + <span class="string">&apos;project&apos;</span>)(x)</span><br><span class="line">    x = layers.BatchNormalization(</span><br><span class="line">        epsilon=<span class="number">1e-3</span>, momentum=<span class="number">0.999</span>, name=prefix + <span class="string">&apos;project_BN&apos;</span>)(x)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> in_channels == pointwise_filters <span class="keyword">and</span> stride == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># &#x76F8;&#x52A0;</span></span><br><span class="line">        <span class="keyword">return</span> layers.Add(name=prefix + <span class="string">&apos;add&apos;</span>)([inputs, x])</span><br><span class="line">    <span class="keyword">return</span> x</span><br></pre></td></tr></tbody></table></figure>
<p>&#x53EA;&#x6709;strides = 1 &#x7684;_inverted_res_block &#x624D;&#x8FDB;&#x884C;&#x53E0;&#x52A0;</p>
<p><img src="/2018/11/02/mobilenet/compare2.png"></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Êú¨Êñá‰ΩúËÄÖÔºö</strong>
    Chen Zhou
  </li>

  <li class="post-copyright-license">
    <strong>ÁâàÊùÉÂ£∞ÊòéÔºö </strong>
    Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/20/shiro-springboot/" rel="next" title="Springboot Êï¥Âêà shiro">
                <i class="fa fa-chevron-left"></i> Springboot Êï¥Âêà shiro
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/11/05/composerinstall/" rel="prev" title="hyperledger composer ÂÆâË£ÖÈááÂùë">
                hyperledger composer ÂÆâË£ÖÈááÂùë <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            ÊñáÁ´†ÁõÆÂΩï
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Á´ôÁÇπÊ¶ÇËßà
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/avatar.jpg"
                alt="Chen Zhou" />
            
              <p class="site-author-name" itemprop="name">Chen Zhou</p>
              <p class="site-description motion-element" itemprop="description">Get busy living, or get busy dying.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">Êó•Âøó</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">ÂàÜÁ±ª</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/chenzhou9513" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="chenzhou9513 at zju dot edu dot cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-globe"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Mobile-Net"><span class="nav-number">1.</span> <span class="nav-text">Mobile Net</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ÁÆÄ‰ªã"><span class="nav-number">1.1.</span> <span class="nav-text">ÁÆÄ‰ªã</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Depthwise-Convolution-Âíå-Pointwise-Convolution"><span class="nav-number">1.2.</span> <span class="nav-text">Depthwise Convolution Âíå Pointwise Convolution</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Convolution"><span class="nav-number">1.2.1.</span> <span class="nav-text">Convolution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Depthwise-Convolution"><span class="nav-number">1.3.</span> <span class="nav-text">Depthwise Convolution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pointwise-Convolution"><span class="nav-number">1.4.</span> <span class="nav-text">Pointwise Convolution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MobileNetÊ®°Âûã"><span class="nav-number">1.5.</span> <span class="nav-text">MobileNetÊ®°Âûã</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MobileNetV2Ê®°Âûã"><span class="nav-number">1.6.</span> <span class="nav-text">MobileNetV2Ê®°Âûã</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen Zhou</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> ËÆøÈóÆ
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      Ê¨°
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> ÊÄªËÆøÈóÆÈáè
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      Ê¨°
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  


  




	





  





  












  





  

  

  

  
  

  
  


  

  

</body>
</html>
